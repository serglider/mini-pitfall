<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Pitfall</title>
	<style>
		body { background: #333; }
	</style>
</head>
<body>
<script>
	// do we need this?
	(function() {
	    var lastTime = 0, vendors = ["ms", "moz", "webkit", "o"];
	    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
	        window.requestAnimationFrame = window[vendors[x]+"RequestAnimationFrame"];
	        window.cancelAnimationFrame = window[vendors[x]+"CancelAnimationFrame"]
	                                   || window[vendors[x]+"CancelRequestAnimationFrame"];
	    }
	    if (!window.requestAnimationFrame)
	        window.requestAnimationFrame = function(callback, element) {
	            var currTime = new Date().getTime();
	            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
	            var id = window.setTimeout(function() { callback(currTime + timeToCall); },
	              timeToCall);
	            lastTime = currTime + timeToCall;
	            return id;
	        };
	    if (!window.cancelAnimationFrame)
	        window.cancelAnimationFrame = function(id) {
	            clearTimeout(id);
	        };
	}());
</script>
<script src="pitfall.js"></script>
<script>
	var pitfall = new Pitfall({
		height: 27, // 9, 18, 27, 36
		width: 13,
		playerWidth: 1,

		square: 35, // I've came up with this for the testing purposes.
					// My previous idea about scaling via CSS didn't work
					// because of browser's antialiasing.
					// Set 1 here to have a pixel per square.

		pathWidth: 6, // self explanatory I think

		changePathDirFrequency: 10,  // script will randomly choose a number
									 // from the range between this value and zero.
									 // This number will be a length of the current stretch of the road.

		updateFrequency: 160,        // speed of animation
		levelTimeIncrement: 10,      // seconds
		levelUpTime: 1,              // seconds
		levelSpeedIncrement: 10,     // percent

		levelComplexityIncrement: 5, // ? not sure if there"s a smart way to do this

		colors: {
			level: [
				{
					terrain: "#B64926",
					edge: "#FFB03B",
					background: "#8E2800"
				},
				{
					terrain: "#00261C",
					edge: "#044C29",
					background: "#167F39"
				},
				{
					terrain: "#6B4E15",
					edge: "#C47B24",
					background: "#CCAF6B"
				},
				{
					terrain: "#00215E",
					edge: "#003CAA",
					background: "#1967F7"
				},
				{
					terrain: "#B64926",
					edge: "#FFB03B",
					background: "#8E2800"
				},
				{
					terrain: "#00261C",
					edge: "#044C29",
					background: "#167F39"
				},
				{
					terrain: "#6B4E15",
					edge: "#C47B24",
					background: "#CCAF6B"
				}
			],
			playerHealth: [
				"#1E1E1F",
				"#424143",
				"#67666A",
				"#807F83",
				"#CBC9CF"
			],
			levelUp: {
				terrain: "#450003",
				edge: "#5C0002",
				background: "#94090D"
			}
		},
		sounds: {
			playerHit: "media/hit.mp3",
			levelUp: "media/hit.mp3",
			gameStart: "media/gamestart.mp3"
		}
	});

	window.onkeydown = function(event) {
		event.preventDefault();
		switch ( event.which ) {
			case 27: pitfall.restart(); break;
			case 32: pitfall.pause(); break;
			case 37: pitfall.move("left"); break;
			case 39: pitfall.move("right"); break;
		}
	};
</script>
</body>
</html>
